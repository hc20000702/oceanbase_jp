-- echo INITIALIZATION
CREATE TABLE NULL_TABLE(ID INT, NUM INT NULLABLE, PRICE FLOAT NOT NULL, BIRTHDAY DATE NULLABLE);
CREATE TABLE NULL_TABLE2(ID INT, NUM INT NULLABLE, PRICE FLOAT NOT NULL, BIRTHDAY DATE NULLABLE);
CREATE INDEX INDEX_NUM ON NULL_TABLE(NUM);

-- echo 1. INSERT
INSERT INTO NULL_TABLE VALUES (1, 18, 10.0, '2020-01-01');
INSERT INTO NULL_TABLE VALUES (2, NULL, 20.0, '2010-01-11');
INSERT INTO NULL_TABLE VALUES (3, 12, 30.0, NULL);
INSERT INTO NULL_TABLE VALUES (4, 15, 30.0, '2021-01-31');
INSERT INTO NULL_TABLE2 VALUES (1, 18, 30.0, '2021-01-31');
INSERT INTO NULL_TABLE2 VALUES (2, NULL, 40.0, NULL);

INSERT INTO NULL_TABLE VALUES (5, 15, NULL, '2021-01-31');
INSERT INTO NULL_TABLE VALUES (NULL, 15, 30.0, '2021-01-31');

-- echo 2. SELECT
-- sort SELECT * FROM NULL_TABLE;

-- echo 3. SELECT WITH CONSTANT
-- sort SELECT * FROM NULL_TABLE WHERE 1 IS NULL;
-- sort SELECT * FROM NULL_TABLE WHERE 1 IS NOT NULL;
-- sort SELECT * FROM NULL_TABLE WHERE NULL=1;
-- sort SELECT * FROM NULL_TABLE WHERE 1=NULL;
-- sort SELECT * FROM NULL_TABLE WHERE 1<>NULL;
-- sort SELECT * FROM NULL_TABLE WHERE 1<NULL;
-- sort SELECT * FROM NULL_TABLE WHERE 1>NULL;

-- sort SELECT * FROM NULL_TABLE WHERE NULL IS NULL;
-- sort SELECT * FROM NULL_TABLE WHERE NULL IS NOT NULL;
-- sort SELECT * FROM NULL_TABLE WHERE NULL=NULL;
-- sort SELECT * FROM NULL_TABLE WHERE NULL<>NULL;
-- sort SELECT * FROM NULL_TABLE WHERE NULL>NULL;
-- sort SELECT * FROM NULL_TABLE WHERE NULL<NULL;

-- sort SELECT * FROM NULL_TABLE WHERE 'A' IS NULL;
-- sort SELECT * FROM NULL_TABLE WHERE 'A' IS NOT NULL;
-- sort SELECT * FROM NULL_TABLE WHERE NULL='A';
-- sort SELECT * FROM NULL_TABLE WHERE 'A'=NULL;
-- sort SELECT * FROM NULL_TABLE WHERE 'A'<>NULL;
-- sort SELECT * FROM NULL_TABLE WHERE 'A'>NULL;
-- sort SELECT * FROM NULL_TABLE WHERE 'A'<NULL;

-- sort SELECT * FROM NULL_TABLE WHERE '2021-01-31' IS NULL;
-- sort SELECT * FROM NULL_TABLE WHERE '2021-01-31' IS NOT NULL;
-- sort SELECT * FROM NULL_TABLE WHERE NULL='2021-01-31';
-- sort SELECT * FROM NULL_TABLE WHERE '2021-01-31'=NULL;
-- sort SELECT * FROM NULL_TABLE WHERE '2021-01-31'>NULL;
-- sort SELECT * FROM NULL_TABLE WHERE '2021-01-31'<NULL;

-- echo 4. SELECT WITH COLUMN
-- sort SELECT * FROM NULL_TABLE WHERE BIRTHDAY IS NOT NULL;
-- sort SELECT * FROM NULL_TABLE WHERE BIRTHDAY IS NULL;
-- sort SELECT * FROM NULL_TABLE WHERE BIRTHDAY = NULL;
-- sort SELECT * FROM NULL_TABLE WHERE NULL = BIRTHDAY;
-- sort SELECT * FROM NULL_TABLE WHERE BIRTHDAY <> NULL;
-- sort SELECT * FROM NULL_TABLE WHERE BIRTHDAY > NULL;
-- sort SELECT * FROM NULL_TABLE WHERE BIRTHDAY < NULL;

-- sort SELECT * FROM NULL_TABLE WHERE NUM IS NOT NULL;
-- sort SELECT * FROM NULL_TABLE WHERE NUM IS NULL;
-- sort SELECT * FROM NULL_TABLE WHERE NUM = NULL;
-- sort SELECT * FROM NULL_TABLE WHERE NULL = NUM;
-- sort SELECT * FROM NULL_TABLE WHERE NUM <> NULL;
-- sort SELECT * FROM NULL_TABLE WHERE NUM > NULL;
-- sort SELECT * FROM NULL_TABLE WHERE NUM < NULL;

-- sort SELECT NULL_TABLE.NUM,NULL_TABLE2.NUM,NULL_TABLE.BIRTHDAY FROM NULL_TABLE,NULL_TABLE2 WHERE NULL_TABLE.NUM=NULL_TABLE2.NUM;

-- echo 5. AGGREGATION
SELECT COUNT(*) FROM NULL_TABLE;
SELECT COUNT(PRICE) FROM NULL_TABLE;
SELECT COUNT(BIRTHDAY) FROM NULL_TABLE;
SELECT AVG(NUM) FROM NULL_TABLE;

-- echo 6. AGGREGATION WITH NULL COLUMNS
CREATE TABLE NULL_TABLE3(ID INT, NUM INT NULLABLE);
INSERT INTO NULL_TABLE3 VALUES (1, NULL);
INSERT INTO NULL_TABLE3 VALUES (2, NULL);
SELECT COUNT(NUM) FROM NULL_TABLE3;
SELECT MIN(NUM) FROM NULL_TABLE3;
SELECT MAX(NUM) FROM NULL_TABLE3;
SELECT AVG(NUM) FROM NULL_TABLE3;

-- echo 7. UNIQUE AND DELETE
CREATE TABLE NULL_TABLE4(ID1 INT NULLABLE, ID2 INT NULLABLE, ID3 FLOAT NULLABLE);
CREATE UNIQUE INDEX ID1_ID2 ON NULL_TABLE4(ID1, ID2);
INSERT INTO NULL_TABLE4 VALUES (1, NULL, 1);
INSERT INTO NULL_TABLE4 VALUES (1, NULL, NULL);
INSERT INTO NULL_TABLE4 VALUES (NULL, NULL, NULL);
INSERT INTO NULL_TABLE4 VALUES (NULL, NULL, 1.4);
INSERT INTO NULL_TABLE4 VALUES (2, 2, 1.2);
INSERT INTO NULL_TABLE4 VALUES (2, 2, 1.3);

-- sort SELECT * FROM NULL_TABLE4;

DELETE FROM NULL_TABLE4 WHERE ID2 = NULL;

-- sort SELECT * FROM NULL_TABLE4;

DELETE FROM NULL_TABLE4 WHERE ID1 = 1 AND ID2 = NULL;

-- sort SELECT * FROM NULL_TABLE4;

DELETE FROM NULL_TABLE4 WHERE ID2 IS NULL AND ID1 IS NOT NULL;

-- sort SELECT * FROM NULL_TABLE4;

DELETE FROM NULL_TABLE4 WHERE ID1 = 2;

-- sort SELECT * FROM NULL_TABLE4;

DELETE FROM NULL_TABLE4 WHERE ID3 = 1.4;

SELECT * FROM NULL_TABLE4;

-- echo 8. UPDATE & TYPECAST
CREATE TABLE NULL_TABLE5(ID INT NULLABLE, NUM INT NULLABLE, NAME CHAR NULLABLE, NAME2 CHAR NOT NULL);
CREATE INDEX ID_T5 ON NULL_TABLE5(ID);
INSERT INTO NULL_TABLE5 VALUES (1, 1, 'N1', 'N1');
INSERT INTO NULL_TABLE5 VALUES (2, 2, 'N2', 'N2');
INSERT INTO NULL_TABLE5 VALUES (3, 3, 'N3', 'N3');
INSERT INTO NULL_TABLE5 VALUES (3, 3, 'N3', NULL);
UPDATE NULL_TABLE5 SET NUM=NULL WHERE ID=1;
UPDATE NULL_TABLE5 SET NAME=NULL WHERE NUM=NULL;

-- sort SELECT ID, NUM, NAME FROM NULL_TABLE5;

UPDATE NULL_TABLE5 SET NAME=NULL WHERE NUM IS NULL;

-- sort SELECT ID, NUM, NAME FROM NULL_TABLE5;

UPDATE NULL_TABLE5 SET ID=NULL WHERE NUM=2;

-- sort SELECT ID, NUM, NAME FROM NULL_TABLE5;

UPDATE NULL_TABLE5 SET ID=(SELECT NULL_TABLE5.ID FROM NULL_TABLE5 WHERE NULL_TABLE5.NUM=2) WHERE ID=3;

-- sort SELECT * FROM NULL_TABLE5;

UPDATE NULL_TABLE5 SET NAME2=(SELECT NULL_TABLE5.ID FROM NULL_TABLE5 WHERE NULL_TABLE5.NUM=2) WHERE ID=1;

-- sort SELECT * FROM NULL_TABLE5;

UPDATE NULL_TABLE5 SET NAME=(SELECT ID FROM NULL_TABLE5 WHERE NUM=30) WHERE NUM=2;

-- sort SELECT * FROM NULL_TABLE5;

UPDATE NULL_TABLE5 SET NAME=(SELECT ID FROM NULL_TABLE5 WHERE ID=1) WHERE NUM=2;

-- sort SELECT * FROM NULL_TABLE5;

UPDATE NULL_TABLE5 SET NAME=(SELECT NULL_TABLE3.NUM FROM NULL_TABLE3 WHERE NULL_TABLE3.ID=1) WHERE NUM=2;

-- sort SELECT * FROM NULL_TABLE5;

UPDATE NULL_TABLE5 SET NAME=(SELECT NULL_TABLE3.NUM FROM NULL_TABLE3 WHERE NULL_TABLE3.ID=1) WHERE ID=1;

-- sort SELECT * FROM NULL_TABLE5;

UPDATE NULL_TABLE5 SET ID=1 WHERE ID IS NULL;
UPDATE NULL_TABLE5 SET ID=2 WHERE NUM=3;
UPDATE NULL_TABLE5 SET NAME=(SELECT NULL_TABLE3.NUM FROM NULL_TABLE3 WHERE NULL_TABLE3.ID=1) WHERE ID=2;

-- sort SELECT * FROM NULL_TABLE5;

UPDATE NULL_TABLE5 SET NAME2=NULL WHERE NUM IS NULL;
UPDATE NULL_TABLE5 SET NAME2 IS NULL WHERE NUM IS NULL;
UPDATE NULL_TABLE5 SET NUM=(SELECT NULL_TABLE3.NUM FROM NULL_TABLE3 WHERE NULL_TABLE3.ID=1) WHERE NAME2='N2';

-- sort SELECT * FROM NULL_TABLE5;

CREATE TABLE NULL_TABLE6(ID INT, NUM INT NULLABLE, NAME CHAR NULLABLE);
INSERT INTO NULL_TABLE6 VALUES(1, 1, 'N1');
INSERT INTO NULL_TABLE6 VALUES(2, 2, 'N2');
INSERT INTO NULL_TABLE6 VALUES(3, 3, 'N3');
UPDATE NULL_TABLE6 SET NUM=NULL WHERE ID=1;
UPDATE NULL_TABLE6 SET NAME=NULL WHERE NUM=NULL;

-- sort SELECT * FROM NULL_TABLE6;

UPDATE NULL_TABLE6 SET ID=NULL WHERE NUM IS NULL;
UPDATE NULL_TABLE6 SET NAME=NULL WHERE NUM IS NULL;
UPDATE NULL_TABLE6 SET NUM=(SELECT NULL_TABLE3.NUM FROM NULL_TABLE3 WHERE NULL_TABLE3.ID=1) WHERE ID=2;

-- sort SELECT * FROM NULL_TABLE6;
